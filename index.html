<!DOCTYPE html>
<html>
  <head>
    <title>Hard-coded JSON Example</title>
    <script
      type="text/javascript"
      src="https://tiiny.host/ad-script.js"
    ></script>
    <script
      defer=""
      data-domain="white-margi-51.tiiny.site"
      src="https://analytics.tiiny.site/js/plausible.js"
    ></script>
  </head>
  <body>
    <div id="question-container">
      <h2>Question:</h2>
      <p id="question"></p>
    </div>
    <div id="options-container">
      <h2>Options:</h2>
      <ul id="options"></ul>
    </div>
    <div id="answer-container">
      <h2>Answer:</h2>
      <p id="answer"></p>
    </div>
    <div id="button-container">
      <button id="next-btn">Next</button>
    </div>
    <div id="stats-container">
      <p>Remaining Questions: <span id="remaining-questions-count"></span></p>
      <p>Correct Answers: <span id="correct-answers-count"></span></p>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        fetch("questions.json")
          .then((response) => response.json())
          .then((data) => {
            const questions = data.questions;
            shuffleArray(questions);

            let currentQuestionIndex = 0;
            let remainingQuestionsCount = questions.length;
            let correctAnswersCount = 0;

            const questionElement = document.getElementById("question");
            const optionsElement = document.getElementById("options");
            const answerElement = document.getElementById("answer");
            const nextButton = document.getElementById("next-btn");
            const remainingQuestionsCountElement = document.getElementById(
              "remaining-questions-count"
            );
            const correctAnswersCountElement = document.getElementById(
              "correct-answers-count"
            );

            function shuffleArray(array) {
              for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
              }
            }

            function loadQuestion() {
              const question = questions[currentQuestionIndex];
              questionElement.textContent = question.question;

              optionsElement.innerHTML = "";
              answerElement.innerHTML = "";

              question.options.forEach((option) => {
                const li = document.createElement("li");
                li.textContent = option;
                optionsElement.appendChild(li);
              });

              const showAnswerButton = document.createElement("button");
              showAnswerButton.textContent = "Show Correct Answer";
              showAnswerButton.className = "show-answer";

              showAnswerButton.addEventListener("click", () => {
                answerElement.innerHTML = "Correct Answer: " + question.answer;

                const userResponseContainer = document.createElement("div");
                const responseLabel = document.createElement("label");
                responseLabel.textContent = "Did you answer correctly?";
                const yesButton = document.createElement("button");
                yesButton.textContent = "Yes";
                const noButton = document.createElement("button");
                noButton.textContent = "No";

                yesButton.addEventListener("click", () => {
                  correctAnswersCount++;
                  remainingQuestionsCount--;
                  questions.splice(currentQuestionIndex, 1);
                  nextQuestion();
                });

                noButton.addEventListener("click", () => {
                  nextQuestion();
                });

                userResponseContainer.appendChild(responseLabel);
                userResponseContainer.appendChild(yesButton);
                userResponseContainer.appendChild(noButton);
                answerElement.appendChild(userResponseContainer);
              });

              answerElement.appendChild(showAnswerButton);
            }

            function nextQuestion() {
              currentQuestionIndex++;
              if (currentQuestionIndex < questions.length) {
                loadQuestion();
              } else {
                // Aici poti adauga cod pentru a gestiona finalizarea quiz-ului
              }
              remainingQuestionsCountElement.textContent =
                remainingQuestionsCount;
              correctAnswersCountElement.textContent = correctAnswersCount;
            }

            loadQuestion();
            nextButton.addEventListener("click", nextQuestion);
          });
      });
    </script>
  </body>
</html>
